{"name":"Four devices with 9 lights each","description":"Device1 : http://192.168.1.151:5100\r\nDevice2 : http://192.168.1.152:5100\r\nDevice3 : http://192.168.1.153:5100\r\nDevice4:  http://192.168.1.154:5100","code":"//use the using array to include external controls into you card\r\nvar using = [\"DiodeCtrl\", \"SliderCtrl\", \"SvgCtrl\"];\r\n\r\nvar device1, device2, device3, device4;\r\n\r\nfunction updateView(device, pinValues ) {\r\n        //log(\"updateView start\");\r\n        //log(\"pinValues\");logObj(pinValues);\r\n\t\tfor(var i = 0; i<pinValues.length;i++){\r\n\t\t\tdevice.get(pinValues[i].pin).setValue(pinValues[i].val);\t\t\t\r\n\t\t\t\r\n\t\t} // for\r\n\t\t//log(\"updateView end\");\r\n}\r\nfunction getDevice(pin){\r\n    console.log(\"getDevice(pin)\");\r\n    console.log(pin);\r\n\tswitch(pin.deviceID) {\r\n\t\tcase 2: return device2;\r\n\t\tcase 3: return device3;\r\n\t\tcase 4: return device4;\r\n\t}\r\n\treturn device1;\r\n}\r\nfunction onClickCAllback(obj){\r\n\tvar pin = obj.pinObject;\r\n\tvar value = obj.getPinValue();\r\n\tpin.active(false);\r\n\tvar sendObj = {};\r\n\tsendObj[pin.getNumber()] = value;\r\n\tvar dev = getDevice(pin);\r\n\t//var posting = $.post( pin.savedDeviceID+'/pins', sendObj);\r\n\t\r\n\t//var url = getServer()+'/devices/pins';\r\n\tvar url = getServer()+'/devices/pins/'+ pin.savedDeviceID;\r\n\tvar posting = $.post( url, sendObj);\r\n\tposting.done(function(data){\r\n\t   // log(\"calling updateView\");\r\n\t\tupdateView(dev, data.pins);\r\n\t});\r\n}\r\n\r\nvar setupAppPins = function setupAppPins(device, xBase, yBase){\r\n\r\n\tvar pin, d,s, x=xBase, offsetX=0, marginX=40, offsetY=yBase;\r\n\tif (device.isFirefox()){\r\n\t\toffsetX=43;\r\n\t\toffsetY+=-23;\r\n\t}\r\n\tfor(var i = 0; i < device.pins.length; i++) {\r\n\t\t\r\n\t\tpin = device.pins[i];\r\n\t\td = new DiodeCtrl(marginX+x,yBase,pin);\r\n\t\ts = new SliderCtrl(marginX+x-(32+offsetX), 75+offsetY, pin);\r\n\t\tx = x + 25;\r\n\t\ts.rotate(270);\r\n\t\ts.scale(0.7);\r\n\t\tpin.registerClicks(onClickCAllback);\r\n\t}\r\n};\r\n\r\nvar setupFailed = function setupFailed(data){\r\n\tconsole.log('Setup failed');\r\n\tconsole.log(data);\r\n};\r\n\r\nfunction drawControls(name, device, xOff, yOff){\r\n\tvar x = xOff+25,\r\n\t\ty = yOff-20;\r\n\tvar svg =  new SvgCtrl(name, x, y, 400, 300);\r\n\tsvg.addItem('rect',{x:2, y:10, width:250, height:175, rx:10, ry:10,\r\n\tstyle:'fill:gray;stroke:gray;stroke-width:1;fill-opacity:0.1;stroke-opacity:0.9'});\r\n\r\n\tvar text = new SvgCtrl(name+'t1', x+45,y+166, 200, 50);\t\r\n\ttext.addText(20, 11, device.savedDeviceID, \"fill:#283438;font-size:11px;\");\r\n\tconsole.log(\"------device-------\");\r\n\tconsole.log(device);\r\n\r\n\tdevice.fetchAllPins(function(){setupAppPins(device, xOff, yOff);}, setupFailed);\r\n}\r\nvar logNumber = 0;\r\nfunction log(str){\r\n    logNumber++;\r\n\t$('#bottom').append('<p>'+logNumber+':'+str+'</p>');\r\n}\r\nfunction logObj(obj){\r\n    logNumber++;\r\n\tvar str;\r\n\tstr = JSON.stringify(obj, null, 4); // (Optional) beautiful indented output.\r\n\tconsole.log(obj); // Logs output to dev tools console.\r\n\t\r\n\tvar temp = \"<hr><pre>\"+logNumber+\":\\n\"+ str +\"</pre><hr>\"; \r\n\t$('#bottom').append(temp);\r\n}\r\n\r\n\r\n$(function () {\r\n    $(\"#controls\").css(\"min-height\", \"350px\");  \r\n\tvar maxValue = 1023;\r\n\tconsole.log(location);\r\n\tconsole.log(\"SERVER\");console.log(getServer());\r\n\t\r\n\t\r\n\tdevice1 = new Device('57afb108b450ab9c2f820507', maxValue);\r\n\tdevice2 = new Device('57b75d339eda5e703998868b', maxValue);\r\n\tdevice3 = new Device('57b75d619eda5e703998868c', maxValue);\r\n\tdevice4 = new Device('57e2a6f74a43074811a0720f', maxValue);\r\n\r\n\tdrawControls('backImage1', device1, 100, 0, 1023);\r\n\tdrawControls('backImage2', device2, 360, 0, 1023);\r\n\tdrawControls('backImage3', device3, 100, 190, 1023);\r\n\tdrawControls('backImage4', device4, 360, 190, 1023);\r\n});\r\n","helpurl":""}